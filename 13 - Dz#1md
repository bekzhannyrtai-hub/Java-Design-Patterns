```mermaid
stateDiagram-v2
    direction LR
    
    %% Определяем состояния [cite: 64, 65, 66, 68, 71, 72]
    state Idle as Ожидание (Idle)
    state WaitingForMoney as Ожидание денег (Waiting For Money)
    state MoneyReceived as Деньги получены (Money Received)
    state TicketDispensed as Билет выдан (Ticket Dispensed)
    state TransactionCanceled as Транзакция отменена (Canceled)

    %% Начальное состояние
    [*] --> Idle [cite: 65]

    %% Переходы [cite: 77]
    
    %% 1. Начало транзакции
    Idle --> WaitingForMoney : Выбор билета [cite: 78]

    %% 2. Внесение средств
    WaitingForMoney --> MoneyReceived : Внесение необходимой суммы [cite: 79]

    %% 3. Завершение транзакции
    MoneyReceived --> TicketDispensed : Выдача билета [cite: 80]

    %% 4. Отмена транзакции
    WaitingForMoney --> TransactionCanceled : Отмена покупки [cite: 81]
    MoneyReceived --> TransactionCanceled : Отмена покупки [cite: 81]

    %% 5. Возврат в начальное состояние
    TicketDispensed --> Idle : Готовность к работе
    TransactionCanceled --> Idle : Возврат к ожиданию
        %% Связи <<include>> и <<extend>>
        UC_ViewSearch ..> UC_Search : <<include>>
        UC_Reserve ..> UC_CancelReserve : <<extend>>
        
    end
